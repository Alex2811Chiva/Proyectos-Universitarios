##Predicciones de variables

library(forecast)
## Warning: package 'forecast' was built under R version 4.3.3
## Registered S3 method overwritten by 'quantmod':
##   method            from
##   as.zoo.data.frame zoo
library(readxl)
## Warning: package 'readxl' was built under R version 4.3.3
library(tseries)
## Warning: package 'tseries' was built under R version 4.3.3
##Mujeres

base_esperanza_mujeres <- read_excel("C:/Users/adria/Documents/BUAP/8vo/Finanzas Bancarias/base_esperanza_mujeres.xls")

time_series_mujeres <- ts(base_esperanza_mujeres$Edad, start = min(base_esperanza_mujeres$Año), frequency = 1)
model_mujeres <- auto.arima(time_series_mujeres)
predictions_mujeres <- forecast(model_mujeres, h = 48)
print(predictions_mujeres)
##      Point Forecast    Lo 80     Hi 80    Lo 95     Hi 95
## 2023       78.10516 77.34908  78.86124 76.94884  79.26149
## 2024       78.40232 77.06191  79.74273 76.35234  80.45230
## 2025       78.49565 76.81872  80.17257 75.93101  81.06028
## 2026       78.70668 76.66292  80.75043 75.58102  81.83233
## 2027       78.84973 76.49034  81.20913 75.24136  82.45811
## 2028       79.03204 76.34966  81.71443 74.92969  83.13440
## 2029       79.19169 76.20063  82.18274 74.61726  83.76611
## 2030       79.36442 76.06218  82.66666 74.31408  84.41476
## 2031       79.52959 75.91947  83.13972 74.00838  85.05080
## 2032       79.69913 75.77900  83.61926 73.70381  85.69445
## 2033       79.86615 75.63532  84.09697 73.39566  86.33664
## 2034       80.03462 75.49050  84.57874 73.08499  86.98426
## 2035       80.20226 75.34248  85.06203 72.76987  87.63464
## 2036       80.37037 75.19184  85.54891 72.45048  88.29026
## 2037       80.53821 75.03776  86.03866 72.12600  88.95042
## 2038       80.70621 74.88038  86.53205 71.79637  89.61606
## 2039       80.87412 74.71934  87.02890 71.46120  90.28704
## 2040       81.04208 74.55464  87.52952 71.12040  90.96376
## 2041       81.21001 74.38613  88.03389 70.77379  91.64623
## 2042       81.37795 74.21378  88.54213 70.42129  92.33462
## 2043       81.54589 74.03752  89.05427 70.06283  93.02896
## 2044       81.71383 73.85733  89.57034 69.69835  93.72932
## 2045       81.88177 73.67318  90.09037 69.32781  94.43574
## 2046       82.04972 73.48506  90.61437 68.95121  95.14822
## 2047       82.21766 73.29297  91.14234 68.56852  95.86679
## 2048       82.38560 73.09690  91.67430 68.17976  96.59144
## 2049       82.55354 72.89686  92.21022 67.78492  97.32215
## 2050       82.72148 72.69286  92.75010 67.38402  98.05893
## 2051       82.88942 72.48490  93.29393 66.97709  98.80175
## 2052       83.05736 72.27302  93.84170 66.56414  99.55058
## 2053       83.22530 72.05722  94.39338 66.14519 100.30541
## 2054       83.39324 71.83752  94.94896 65.72029 101.06619
## 2055       83.56118 71.61394  95.50842 65.28945 101.83291
## 2056       83.72912 71.38651  96.07174 64.85272 102.60552
## 2057       83.89706 71.15524  96.63889 64.41012 103.38400
## 2058       84.06500 70.92016  97.20985 63.96170 104.16831
## 2059       84.23294 70.68129  97.78460 63.50748 104.95841
## 2060       84.40088 70.43866  98.36311 63.04750 105.75427
## 2061       84.56882 70.19228  98.94537 62.58180 106.55585
## 2062       84.73677 69.94219  99.53134 62.11042 107.36311
## 2063       84.90471 69.68841 100.12100 61.63339 108.17602
## 2064       85.07265 69.43096 100.71433 61.15075 108.99454
## 2065       85.24059 69.16987 101.31131 60.66254 109.81863
## 2066       85.40853 68.90515 101.91190 60.16880 110.64826
## 2067       85.57647 68.63684 102.51609 59.66955 111.48339
## 2068       85.74441 68.36496 103.12385 59.16484 112.32398
## 2069       85.91235 68.08954 103.73516 58.65471 113.16999
## 2070       86.08029 67.81058 104.35000 58.13918 114.02140
df_esperanza_mujeres <- as.data.frame(predictions_mujeres)
plot(predictions_mujeres)
 ##Hombres

base_esperanza_hombres <- read_excel("C:/Users/adria/Documents/BUAP/8vo/Finanzas Bancarias/base_esperanza_hombres.xls")
## New names:
## • `` -> `...3`
## • `` -> `...4`
## • `` -> `...5`
## • `` -> `...6`
## • `` -> `...7`
## • `` -> `...8`
## • `` -> `...9`
## • `` -> `...10`
## • `` -> `...11`
## • `` -> `...12`
## • `` -> `...13`
## • `` -> `...14`
## • `` -> `...15`
## • `` -> `...16`
## • `` -> `...17`
## • `` -> `...18`
## • `` -> `...19`
## • `` -> `...20`
## • `` -> `...21`
## • `` -> `...22`
## • `` -> `...23`
## • `` -> `...24`
## • `` -> `...25`
## • `` -> `...26`
## • `` -> `...27`
## • `` -> `...28`
## • `` -> `...29`
## • `` -> `...30`
## • `` -> `...31`
## • `` -> `...32`
## • `` -> `...33`
## • `` -> `...34`
## • `` -> `...35`
## • `` -> `...36`
## • `` -> `...37`
## • `` -> `...38`
## • `` -> `...39`
## • `` -> `...40`
## • `` -> `...41`
## • `` -> `...42`
## • `` -> `...43`
## • `` -> `...44`
## • `` -> `...45`
## • `` -> `...46`
## • `` -> `...47`
## • `` -> `...48`
## • `` -> `...49`
## • `` -> `...50`
## • `` -> `...51`
## • `` -> `...52`
## • `` -> `...53`
## • `` -> `...54`
## • `` -> `...55`
## • `` -> `...56`
## • `` -> `...57`
## • `` -> `...58`
## • `` -> `...59`
## • `` -> `...60`
## • `` -> `...61`
## • `` -> `...62`
## • `` -> `...63`
time_series_hombres <- ts(base_esperanza_hombres$Esperanza, start = min(base_esperanza_hombres$Edad), frequency = 1)
model_hombres <- auto.arima(time_series_hombres)
predictions_hombres <- forecast(model_hombres, h = 47)
print(predictions_hombres)
##      Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95
## 2024       69.45271 68.48165 70.42376 67.96761 70.93781
## 2025       70.25289 68.56988 71.93589 67.67895 72.82682
## 2026       72.13748 70.31522 73.95974 69.35058 74.92439
## 2027       71.70560 69.78087 73.63033 68.76199 74.64922
## 2028       71.18109 68.99247 73.36971 67.83388 74.52829
## 2029       72.06087 69.65960 74.46215 68.38844 75.73331
## 2030       72.65985 70.14449 75.17521 68.81294 76.50676
## 2031       72.48815 69.83678 75.13953 68.43323 76.54308
## 2032       72.66844 69.84878 75.48810 68.35614 76.98073
## 2033       73.22431 70.27135 76.17727 68.70815 77.74047
## 2034       73.48029 70.41437 76.54621 68.79137 78.16921
## 2035       73.58394 70.39248 76.77539 68.70303 78.46485
## 2036       73.90298 70.58626 77.21970 68.83049 78.97547
## 2037       74.26136 70.83442 77.68829 69.02031 79.50240
## 2038       74.48181 70.94814 78.01548 69.07752 79.88610
## 2039       74.71180 71.06866 78.35494 69.14010 80.28350
## 2040       75.02180 71.27375 78.76986 69.28965 80.75396
## 2041       75.30696 71.45984 79.15408 69.42330 81.19063
## 2042       75.55033 71.60518 79.49548 69.51674 81.58392
## 2043       75.81852 71.77635 79.86069 69.63656 82.00048
## 2044       76.10571 71.96995 80.24147 69.78061 82.43081
## 2045       76.37354 72.14677 80.60031 69.90925 82.83783
## 2046       76.63467 72.31802 80.95131 70.03293 83.23640
## 2047       76.90895 72.50416 81.31373 70.17241 83.64549
## 2048       77.18408 72.69335 81.67481 70.31610 84.05206
## 2049       77.45116 72.87605 82.02627 70.45414 84.44818
## 2050       77.71966 73.06144 82.37788 70.59553 84.84379
## 2051       77.99262 73.25284 82.73240 70.74375 85.24149
## 2052       78.26367 73.44384 83.08351 70.89237 85.63497
## 2053       78.53252 73.63385 83.43118 71.04066 86.02438
## 2054       78.80303 73.82673 83.77933 71.19244 86.41362
## 2055       79.07446 74.02178 84.12714 71.34705 86.80187
## 2056       79.34467 74.21677 84.47258 71.50222 87.18713
## 2057       79.61463 74.41255 84.81672 71.65873 87.57054
## 2058       79.88538 74.61016 85.16060 71.81762 87.95313
## 2059       80.15609 74.80875 85.50342 71.97804 88.33413
## 2060       80.42634 75.00784 85.84483 72.13947 88.71320
## 2061       80.69672 75.20798 86.18546 72.30241 89.09102
## 2062       80.96734 75.40924 86.52543 72.46697 89.46771
## 2063       81.23783 75.61124 86.86441 72.63270 89.84295
## 2064       81.50820 75.81394 87.20246 72.79958 90.21682
## 2065       81.77868 76.01754 87.53983 72.96777 90.58959
## 2066       82.04921 76.22195 87.87646 73.13719 90.96123
## 2067       82.31966 76.42703 88.21228 73.30766 91.33165
## 2068       82.59010 76.63282 88.54738 73.47923 91.70097
## 2069       82.86059 76.83935 88.88183 73.65190 92.06928
## 2070       83.13107 77.04655 89.21559 73.82559 92.43655
df_esperanza_hombres <- as.data.frame(predictions_hombres)
plot(predictions_hombres)
 ##Predicciones tasas

base_rendimientos_afores <- read_excel("C:/Users/adria/Documents/BUAP/8vo/Finanzas Bancarias/base_rendimientos_afores.xlsx")
predicciones_afores <- list()


for (i in 1:ncol(base_rendimientos_afores)) {

  time_series_tasas <- ts(base_rendimientos_afores[, i], start = 2024, frequency = 1)
  

  model_tasas <- ets(time_series_tasas)
  
  # Predecir las tasas hasta 2070 (h = 47 para predecir 47 años)
  predicciones <- forecast(model_tasas, h = 47) 
  

  predicciones_afores[[colnames(base_rendimientos_afores)[i]]] <- predicciones
}

años_predicciones <- 2024:2070

df <- as.data.frame(predicciones_afores)
df$Año <- años_predicciones
df <- df[, c("Año", names(df)[names(df) != "Año"])]


point_forecasts <- lapply(predicciones_afores, function(x) x$mean)

df_point_forecasts <- do.call(cbind, point_forecasts)

años_predicciones <- 2024:2070
df_point_forecasts <- as.data.frame(df_point_forecasts)
df_point_forecasts$Año <- años_predicciones

df_point_forecasts <- df_point_forecasts[, c("Año", names(df_point_forecasts)[names(df_point_forecasts) != "Año"])]
print(df_point_forecasts)
##     Año   Azteca   Citibanamex   Coppel   Inbursa   Invercap   PensionISSSTE
## 1  2024 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 2  2025 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 3  2026 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 4  2027 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 5  2028 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 6  2029 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 7  2030 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 8  2031 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 9  2032 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 10 2033 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 11 2034 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 12 2035 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 13 2036 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 14 2037 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 15 2038 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 16 2039 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 17 2040 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 18 2041 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 19 2042 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 20 2043 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 21 2044 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 22 2045 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 23 2046 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 24 2047 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 25 2048 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 26 2049 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 27 2050 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 28 2051 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 29 2052 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 30 2053 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 31 2054 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 32 2055 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 33 2056 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 34 2057 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 35 2058 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 36 2059 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 37 2060 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 38 2061 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 39 2062 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 40 2063 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 41 2064 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 42 2065 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 43 2066 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 44 2067 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 45 2068 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 46 2069 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
## 47 2070 9.142529      7.563863 6.868319  6.532757   7.492933         8.65347
##      Principal   Profuturo     SURA   XXI Banorte
## 1     7.059256    6.519715 8.026825      7.758559
## 2     7.059256    6.519715 8.026825      7.758559
## 3     7.059256    6.519715 8.026825      7.758559
## 4     7.059256    6.519715 8.026825      7.758559
## 5     7.059256    6.519715 8.026825      7.758559
## 6     7.059256    6.519715 8.026825      7.758559
## 7     7.059256    6.519715 8.026825      7.758559
## 8     7.059256    6.519715 8.026825      7.758559
## 9     7.059256    6.519715 8.026825      7.758559
## 10    7.059256    6.519715 8.026825      7.758559
## 11    7.059256    6.519715 8.026825      7.758559
## 12    7.059256    6.519715 8.026825      7.758559
## 13    7.059256    6.519715 8.026825      7.758559
## 14    7.059256    6.519715 8.026825      7.758559
## 15    7.059256    6.519715 8.026825      7.758559
## 16    7.059256    6.519715 8.026825      7.758559
## 17    7.059256    6.519715 8.026825      7.758559
## 18    7.059256    6.519715 8.026825      7.758559
## 19    7.059256    6.519715 8.026825      7.758559
## 20    7.059256    6.519715 8.026825      7.758559
## 21    7.059256    6.519715 8.026825      7.758559
## 22    7.059256    6.519715 8.026825      7.758559
## 23    7.059256    6.519715 8.026825      7.758559
## 24    7.059256    6.519715 8.026825      7.758559
## 25    7.059256    6.519715 8.026825      7.758559
## 26    7.059256    6.519715 8.026825      7.758559
## 27    7.059256    6.519715 8.026825      7.758559
## 28    7.059256    6.519715 8.026825      7.758559
## 29    7.059256    6.519715 8.026825      7.758559
## 30    7.059256    6.519715 8.026825      7.758559
## 31    7.059256    6.519715 8.026825      7.758559
## 32    7.059256    6.519715 8.026825      7.758559
## 33    7.059256    6.519715 8.026825      7.758559
## 34    7.059256    6.519715 8.026825      7.758559
## 35    7.059256    6.519715 8.026825      7.758559
## 36    7.059256    6.519715 8.026825      7.758559
## 37    7.059256    6.519715 8.026825      7.758559
## 38    7.059256    6.519715 8.026825      7.758559
## 39    7.059256    6.519715 8.026825      7.758559
## 40    7.059256    6.519715 8.026825      7.758559
## 41    7.059256    6.519715 8.026825      7.758559
## 42    7.059256    6.519715 8.026825      7.758559
## 43    7.059256    6.519715 8.026825      7.758559
## 44    7.059256    6.519715 8.026825      7.758559
## 45    7.059256    6.519715 8.026825      7.758559
## 46    7.059256    6.519715 8.026825      7.758559
## 47    7.059256    6.519715 8.026825      7.758559
##Predicciones Comisiones

base_comisiones_afores <- read_excel("C:/Users/adria/Documents/BUAP/8vo/Finanzas Bancarias/base_comisiones_afores.xlsx",sheet = "Hoja2")
predicciones_comisiones <- list()


colnames(base_comisiones_afores)[colnames(base_comisiones_afores) == "XXI Banorte"] <- "XXI_Banorte" 

for (i in 1:ncol(base_comisiones_afores)) {
  
  time_series_comisiones <- ts(base_comisiones_afores[, i], start = 2019, frequency = 1)
  
 
  model_comisiones <- ets(time_series_comisiones)
  
  
  predicciones_comision_temp <- forecast(model_comisiones, h = 47) 
  
  
  predicciones_comisiones[[colnames(base_comisiones_afores)[i]]] <- predicciones_comision_temp
}

df_comisiones <- as.data.frame(predicciones_comisiones)

colnames(df_comisiones)[colnames(df_comisiones) == "XXI.Banorte"] <- "XXI_Banorte" 

años_predicciones <- 2024:2070
df_comisiones$Año <- años_predicciones

df_comisiones <- df_comisiones[, c("Año", names(df_comisiones)[names(df_comisiones) != "Año"])]

point_forecasts_comisiones <- lapply(predicciones_comisiones, function(x) x$mean)

df_point_forecasts_comisiones <- do.call(cbind, point_forecasts_comisiones)

df_point_forecasts_comisiones <- as.data.frame(df_point_forecasts_comisiones)
df_point_forecasts_comisiones$Año <- años_predicciones

df_point_forecasts_comisiones <- df_point_forecasts_comisiones[, c("Año", names(df_point_forecasts_comisiones)[names(df_point_forecasts_comisiones) != "Año"])]

print(df_point_forecasts_comisiones)
##     Año      Azteca   Citibanamex   Coppel   Inbursa   Invercap   PensionISSSTE
## 1  2024  0.48318301    0.50536315    0.566      0.57       0.57            0.53
## 2  2025  0.39649386    0.44073415    0.566      0.57       0.57            0.53
## 3  2026  0.30980471    0.37610515    0.566      0.57       0.57            0.53
## 4  2027  0.22311555    0.31147615    0.566      0.57       0.57            0.53
## 5  2028  0.13642640    0.24684715    0.566      0.57       0.57            0.53
## 6  2029  0.04973725    0.18221815    0.566      0.57       0.57            0.53
## 7  2030 -0.03695191    0.11758915    0.566      0.57       0.57            0.53
## 8  2031 -0.12364106    0.05296015    0.566      0.57       0.57            0.53
## 9  2032 -0.21033021   -0.01166886    0.566      0.57       0.57            0.53
## 10 2033 -0.29701937   -0.07629786    0.566      0.57       0.57            0.53
## 11 2034 -0.38370852   -0.14092686    0.566      0.57       0.57            0.53
## 12 2035 -0.47039768   -0.20555586    0.566      0.57       0.57            0.53
## 13 2036 -0.55708683   -0.27018486    0.566      0.57       0.57            0.53
## 14 2037 -0.64377598   -0.33481386    0.566      0.57       0.57            0.53
## 15 2038 -0.73046514   -0.39944286    0.566      0.57       0.57            0.53
## 16 2039 -0.81715429   -0.46407186    0.566      0.57       0.57            0.53
## 17 2040 -0.90384344   -0.52870086    0.566      0.57       0.57            0.53
## 18 2041 -0.99053260   -0.59332986    0.566      0.57       0.57            0.53
## 19 2042 -1.07722175   -0.65795887    0.566      0.57       0.57            0.53
## 20 2043 -1.16391090   -0.72258787    0.566      0.57       0.57            0.53
## 21 2044 -1.25060006   -0.78721687    0.566      0.57       0.57            0.53
## 22 2045 -1.33728921   -0.85184587    0.566      0.57       0.57            0.53
## 23 2046 -1.42397837   -0.91647487    0.566      0.57       0.57            0.53
## 24 2047 -1.51066752   -0.98110387    0.566      0.57       0.57            0.53
## 25 2048 -1.59735667   -1.04573287    0.566      0.57       0.57            0.53
## 26 2049 -1.68404583   -1.11036187    0.566      0.57       0.57            0.53
## 27 2050 -1.77073498   -1.17499087    0.566      0.57       0.57            0.53
## 28 2051 -1.85742413   -1.23961988    0.566      0.57       0.57            0.53
## 29 2052 -1.94411329   -1.30424888    0.566      0.57       0.57            0.53
## 30 2053 -2.03080244   -1.36887788    0.566      0.57       0.57            0.53
## 31 2054 -2.11749159   -1.43350688    0.566      0.57       0.57            0.53
## 32 2055 -2.20418075   -1.49813588    0.566      0.57       0.57            0.53
## 33 2056 -2.29086990   -1.56276488    0.566      0.57       0.57            0.53
## 34 2057 -2.37755906   -1.62739388    0.566      0.57       0.57            0.53
## 35 2058 -2.46424821   -1.69202288    0.566      0.57       0.57            0.53
## 36 2059 -2.55093736   -1.75665188    0.566      0.57       0.57            0.53
## 37 2060 -2.63762652   -1.82128088    0.566      0.57       0.57            0.53
## 38 2061 -2.72431567   -1.88590989    0.566      0.57       0.57            0.53
## 39 2062 -2.81100482   -1.95053889    0.566      0.57       0.57            0.53
## 40 2063 -2.89769398   -2.01516789    0.566      0.57       0.57            0.53
## 41 2064 -2.98438313   -2.07979689    0.566      0.57       0.57            0.53
## 42 2065 -3.07107229   -2.14442589    0.566      0.57       0.57            0.53
## 43 2066 -3.15776144   -2.20905489    0.566      0.57       0.57            0.53
## 44 2067 -3.24445059   -2.27368389    0.566      0.57       0.57            0.53
## 45 2068 -3.33113975   -2.33831289    0.566      0.57       0.57            0.53
## 46 2069 -3.41782890   -2.40294189    0.566      0.57       0.57            0.53
## 47 2070 -3.50451805   -2.46757090    0.566      0.57       0.57            0.53
##       Principal   Profuturo        SURA   XXI Banorte
## 1   0.474154388  0.49012359  0.49683067  5.181736e-01
## 2   0.378318400  0.41025615  0.42366866  4.663526e-01
## 3   0.282482411  0.33038871  0.35050665  4.145315e-01
## 4   0.186646423  0.25052128  0.27734464  3.627104e-01
## 5   0.090810435  0.17065384  0.20418263  3.108893e-01
## 6  -0.005025554  0.09078640  0.13102062  2.590683e-01
## 7  -0.100861542  0.01091897  0.05785861  2.072472e-01
## 8  -0.196697530 -0.06894847 -0.01530340  1.554261e-01
## 9  -0.292533519 -0.14881591 -0.08846541  1.036050e-01
## 10 -0.388369507 -0.22868334 -0.16162742  5.178395e-02
## 11 -0.484205495 -0.30855078 -0.23478944 -3.712385e-05
## 12 -0.580041484 -0.38841822 -0.30795145 -5.185820e-02
## 13 -0.675877472 -0.46828565 -0.38111346 -1.036793e-01
## 14 -0.771713460 -0.54815309 -0.45427547 -1.555004e-01
## 15 -0.867549448 -0.62802053 -0.52743748 -2.073214e-01
## 16 -0.963385437 -0.70788796 -0.60059949 -2.591425e-01
## 17 -1.059221425 -0.78775540 -0.67376150 -3.109636e-01
## 18 -1.155057413 -0.86762284 -0.74692351 -3.627847e-01
## 19 -1.250893402 -0.94749027 -0.82008552 -4.146057e-01
## 20 -1.346729390 -1.02735771 -0.89324753 -4.664268e-01
## 21 -1.442565378 -1.10722515 -0.96640954 -5.182479e-01
## 22 -1.538401367 -1.18709258 -1.03957155 -5.700690e-01
## 23 -1.634237355 -1.26696002 -1.11273356 -6.218900e-01
## 24 -1.730073343 -1.34682746 -1.18589557 -6.737111e-01
## 25 -1.825909331 -1.42669490 -1.25905758 -7.255322e-01
## 26 -1.921745320 -1.50656233 -1.33221959 -7.773533e-01
## 27 -2.017581308 -1.58642977 -1.40538160 -8.291744e-01
## 28 -2.113417296 -1.66629721 -1.47854361 -8.809954e-01
## 29 -2.209253285 -1.74616464 -1.55170562 -9.328165e-01
## 30 -2.305089273 -1.82603208 -1.62486763 -9.846376e-01
## 31 -2.400925261 -1.90589952 -1.69802965 -1.036459e+00
## 32 -2.496761250 -1.98576695 -1.77119166 -1.088280e+00
## 33 -2.592597238 -2.06563439 -1.84435367 -1.140101e+00
## 34 -2.688433226 -2.14550183 -1.91751568 -1.191922e+00
## 35 -2.784269215 -2.22536926 -1.99067769 -1.243743e+00
## 36 -2.880105203 -2.30523670 -2.06383970 -1.295564e+00
## 37 -2.975941191 -2.38510414 -2.13700171 -1.347385e+00
## 38 -3.071777179 -2.46497157 -2.21016372 -1.399206e+00
## 39 -3.167613168 -2.54483901 -2.28332573 -1.451027e+00
## 40 -3.263449156 -2.62470645 -2.35648774 -1.502848e+00
## 41 -3.359285144 -2.70457388 -2.42964975 -1.554669e+00
## 42 -3.455121133 -2.78444132 -2.50281176 -1.606491e+00
## 43 -3.550957121 -2.86430876 -2.57597377 -1.658312e+00
## 44 -3.646793109 -2.94417619 -2.64913578 -1.710133e+00
## 45 -3.742629098 -3.02404363 -2.72229779 -1.761954e+00
## 46 -3.838465086 -3.10391107 -2.79545980 -1.813775e+00
## 47 -3.934301074 -3.18377851 -2.86862181 -1.865596e+00
##Inflación

base_inflacion <- read_excel("C:/Users/adria/Documents/BUAP/8vo/Finanzas Bancarias/base_inflacion.xls")
inflacion <- ts(base_inflacion$Tasa, start = c(1960, 1), frequency = 1)

modelo_ets <- ets(inflacion)

predicciones_ets <- forecast(modelo_ets, h = 2070 - 2023)

plot(predicciones_ets)


print(predicciones_ets)
##      Point Forecast        Lo 80     Hi 80        Lo 95     Hi 95
## 2024       5.722251    1.3759484  10.06855   -0.9248452  12.36935
## 2025       5.622390    0.5978968  10.64688   -2.0619094  13.30669
## 2026       5.522530   -0.1677084  11.21277   -3.1799384  14.22500
## 2027       5.422669   -0.9331712  11.77851   -4.2977497  15.14309
## 2028       5.322808   -1.7071441  12.35276   -5.4285760  16.07419
## 2029       5.222947   -2.4963034  12.94220   -6.5826279  17.02852
## 2030       5.123087   -3.3061863  13.55236   -7.7683738  18.01455
## 2031       5.023226   -4.1416529  14.18811   -8.9932468  19.03970
## 2032       4.923365   -5.0071621  14.85389  -10.2640659  20.11080
## 2033       4.823505   -5.9069472  15.55396  -11.5873053  21.23431
## 2034       4.723644   -6.8451339  16.29242  -12.9692750  22.41656
## 2035       4.623783   -7.8258253  17.07339  -14.4162500  23.66382
## 2036       4.523923   -8.8531639  17.90101  -15.9345657  24.98241
## 2037       4.424062   -9.9313814  18.77951  -17.5306940  26.37882
## 2038       4.324201  -11.0648390  19.71324  -19.2113048  27.85971
## 2039       4.224340  -12.2580623  20.70674  -20.9833193  29.43200
## 2040       4.124480  -13.5157718  21.76473  -22.8539570  31.10292
## 2041       4.024619  -14.8429122  22.89215  -24.8307800  32.88002
## 2042       3.924758  -16.2446792  24.09420  -26.9217345  34.77125
## 2043       3.824898  -17.7265462  25.37634  -29.1351915  36.78499
## 2044       3.725037  -19.2942913  26.74437  -31.4799877  38.93006
## 2045       3.625176  -20.9540237  28.20438  -33.9654662  41.21582
## 2046       3.525316  -22.7122111  29.76284  -36.6015188  43.65215
## 2047       3.425455  -24.5757088  31.42662  -39.3986296  46.24954
## 2048       3.325594  -26.5517886  33.20298  -42.3679197  49.01911
## 2049       3.225734  -28.6481700  35.09964  -45.5211953  51.97266
## 2050       3.125873  -30.8730527  37.12480  -48.8709967  55.12274
## 2051       3.026012  -33.2351511  39.28718  -52.4306514  58.48268
## 2052       2.926151  -35.7437301  41.59603  -56.2143288  62.06663
## 2053       2.826291  -38.4086436  44.06123  -60.2370993  65.88968
## 2054       2.726430  -41.2403753  46.69324  -64.5149962  69.96786
## 2055       2.626569  -44.2500816  49.50322  -69.0650817  74.31822
## 2056       2.526709  -47.4496372  52.50305  -73.9055166  78.95893
## 2057       2.426848  -50.8516840  55.70538  -79.0556351  83.90933
## 2058       2.326987  -54.4696827  59.12366  -84.5360236  89.19000
## 2059       2.227127  -58.3179677  62.77222  -90.3686045  94.82286
## 2060       2.127266  -62.4118057  66.66634  -96.5767264 100.83126
## 2061       2.027405  -66.7674579  70.82227 -103.1852585 107.24007
## 2062       1.927544  -71.4022463  75.25734 -110.2206926 114.07578
## 2063       1.827684  -76.3346242  79.98999 -117.7112507 121.36662
## 2064       1.727823  -81.5842515  85.03990 -125.6869997 129.14265
## 2065       1.627962  -87.1720746  90.42800 -134.1799746 137.43590
## 2066       1.528102  -93.1204116  96.17661 -143.2243079 146.28051
## 2067       1.428241  -99.4530432 102.30953 -152.8563692 155.71285
## 2068       1.328380 -106.1953095 108.85207 -163.1149127 165.77167
## 2069       1.228520 -113.3742130 115.83125 -174.0412350 176.49827
## 2070       1.128659 -121.0185282 123.27585 -185.6793432 187.93666
df <- as.data.frame(predicciones_ets)[,c(1,2)]
